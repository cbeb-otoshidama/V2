<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <title>COMBRIDGE&EB お年玉くじ</title>
    <style>
      body {
        text-align: center;
        font-family: "Hiragino Maru Gothic Pro", "Comic Sans MS", sans-serif;
        background: #fff5fb;
        padding: 30px;
      }

      h2 {
        color: #ff66a5;
        font-size: 32px;
        margin-bottom: 10px;
      }

      input {
        width: 250px;
        padding: 10px;
        margin: 8px;
        border-radius: 10px;
        border: 2px solid #ffbad2;
        font-size: 16px;
        outline: none;
      }
      input:focus {
        border-color: #ff66a5;
        background: #fff0f6;
      }

      /* くじ箱 */
      #box {
        width: 300px;
        height: 300px;
        margin: 20px auto;
        position: relative;
      }

      /* くじ箱の画像 */
      .box-icon {
        width: 100%;
        height: 100%;
        object-fit: contain;
        border-radius: 15px;
        position: absolute;
        top: 0;
        left: 0;
      }

      /* くじ箱アニメーション */
      .shake {
        animation: shake 0.5s infinite;
      }
      @keyframes shake {
        0% { transform: rotate(0deg); }
        25% { transform: rotate(2deg); }
        50% { transform: rotate(0deg); }
        75% { transform: rotate(-2deg); }
        100% { transform: rotate(0deg); }
      }

      /* ボタン */
      button {
        background: #ff66a5;
        color: white;
        border: none;
        padding: 12px 25px;
        border-radius: 30px;
        font-size: 16px;
        cursor: pointer;
        box-shadow: 0 4px 10px rgba(255,102,165,0.3);
        transition: 0.2s;
      }
      button:hover {
        background: #ff85b8;
        transform: scale(1.05);
      }

      #remaining {
        font-size: 18px;
        margin-top: 15px;
        color: #ff4f92;
        display: none; /* 初期状態で非表示 */
      }

      /* 結果テキストのスタイル */
      #resultText {
        font-size: 24px;
        color: #ff66a5;
        font-weight: bold;
        margin-top: 20px;
        display: none; /* 初期状態で非表示 */
      }

    </style>
  </head>
  <body>
    <h2>COMBRIDGE&EB
    <br>お年玉くじ
    </h2>
    <input id="name" type="text" placeholder="名前"><br><br>
    <input id="email" type="email" placeholder="メールアドレス"><br><br>
    <button onclick="draw()">くじを引く</button>
    
    <!-- 結果テキスト -->
    <p id="resultText" style="display: none;"></p>
    
    <!-- くじ箱の部分 -->
    <div id="box">
      <img src="box_icon.png" class="box-icon">
    </div>

    <p id="remaining"></p>  <!-- 残りくじ数の部分（非表示） -->

    <script>
      const API_URL = "https://script.google.com/macros/s/AKfycbyMeK6FoKUWdRtBcx0mpfnF6ojGEOHe3xAzBeItFx3INECm0Z8BQXNYs0TwxFsT5B23/exec";
      
      async function draw() {
        const name = document.getElementById("name").value;
        const email = document.getElementById("email").value;
        
        if (!name || !email) {
          alert("名前とメールアドレスを入力してください。");
          return;
        }
        
        const box = document.getElementById("box");
        const resultText = document.getElementById("resultText");
        resultText.style.display = "none"; // 初期状態では隠す
        
        box.classList.add("shake");
        
        // 1秒揺れる
        await new Promise(r => setTimeout(r, 500));
        
        box.classList.remove("shake");
        
        const response = await fetch(API_URL, {
          method: "POST",
          body: JSON.stringify({ name, email })
        });
        
        const data = await response.json();
        
        // 結果テキストに【】で囲んだ結果を表示
        resultText.textContent = "【" + data.result + "】"; // 結果を【】で囲む
        resultText.style.display = "block"; // 結果テキストを表示
        
        // 残りくじ数の表示を非表示にする
        document.getElementById("remaining").style.display = "none";  // 非表示にする
      }
    </script>
  </body>
</html>
